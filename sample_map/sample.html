<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>タイトル</title>
    <style>html,body{height:100%;}body{padding:0;margin:0;background:#333;}h1{padding:0;margin:0;font-size:50%;color:white;}</style>

</head>
<body>

<!-- MAP[START] -->
<h1>Infobox</h1>
<div id="myMap" style='width: 80%;height:97%;'></div>
<!-- MAP[END] -->

<!-- jQuery&GoogleMapsAPI -->
<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
<!-- /jQuery&GoogleMapsAPI -->
<script src="https://www.bing.com/api/maps/mapcontrol?callback=GetMap&key=AnGRUt6H_KsRm3164lLtbojb7H2CKuzgTM91XtOZEZtVT-pxIXvjs-wTHv20kpBm" async defer></script>
<script src="./js/BmapQuery.js"></script>

<script>
    let infobox,map;
    function GetMap() {
        map = new Microsoft.Maps.Map('#myMap', {
            center: new Microsoft.Maps.Location(47.6149, -122.1941),
            zoom: 15
        });
        //Get MAP Infomation
        let center = map.getCenter();
    
        //********************************************************************
        //infobox
        //********************************************************************
        infobox = new Microsoft.Maps.Infobox(center, {
            visible: false
        });
        infobox.setMap(map);//Add infobox to Map
    
        //********************************************************************
        //PushPin
        //********************************************************************
        let pin = new Microsoft.Maps.Pushpin(center);
        pin.metadata = {
            title: 'Pin Title',
            description: 'Pin discription'
        };
        //PushPin:addEvent
        Microsoft.Maps.Events.addHandler(pin, 'click', pushpinClicked);
        map.entities.push(pin); //Add Pushpin to Map
    }
    
    function pushpinClicked(e) {
        //Make sure the infobox has metadata to display.
        if (e.target.metadata) {
            //Set the infobox options with the metadata of the pushpin.
            infobox.setOptions({
                location: e.target.getLocation(),
                title: e.target.metadata.title,
                description: e.target.metadata.description,
                visible: true
            });
        }
    }
</script>
</body>
</html>